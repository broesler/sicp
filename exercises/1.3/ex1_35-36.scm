;;==============================================================================
;;     File: ex1_35.scm
;;  Created: 11/06/2016, 17:09
;;   Author: Bernie Roesler
;;
;;  Description: fixed points
;;
;;==============================================================================

; Find a point where g(x) = x
(define (fixed-point f start)
  (define tol 0.0001)
  (define (close-enough? u v)
    (< (abs (- u v)) tol))
  (define (iter old new)
    ; Print each guess
    (newline)
    (display "Guess: ")
    (display old)
    (cond ((close-enough? old new)
      (newline)
      (display "; Value: ")
      (display new)
      new)
      (else (iter new (f new)))))
  (iter start (f start)))

; Test code
; (fixed-point cos 1.0) ;Value: 0.7390547907469174
; (fixed-point (lambda (y) (+ (sin y) (cos y))) 1.0) ;Value: 1.2586974741689445

;------------------------------------------------------------------------------- 
;        Ex 1.35
;-------------------------------------------------------------------------------
; Golden ratio! x -> 1 + 1/x (i.e. a root of x^2 - x - 1 = 0)
(newline)
(display "Golden ratio:")
(fixed-point (lambda (x) (+ 1.0 (/ 1.0 x))) 1.0) ;Value: 1.6180555555555556

;------------------------------------------------------------------------------- 
;        Ex 1.36
;-------------------------------------------------------------------------------
; Solve x^x = 1000 ==> x -> log(1000) / log(x)
; no average-damping:
(newline)
(display "No average-damping:")
(fixed-point (lambda (x) (/ (log 1000) (log x))) 1.1)

; with average-damping:
(newline)
(display "With average-damping:")
(fixed-point (lambda (x) (/ (+ x (/ (log 1000) (log x))) 2)) 1.1)

;------------------------------------------------------------------------------- 
;       Output 
;-------------------------------------------------------------------------------
; ;  Loading "ex1_35.scm"...
; Golden ratio:
; Guess: 1.
; Guess: 2.
; Guess: 1.5
; Guess: 1.6666666666666665
; Guess: 1.6
; Guess: 1.625
; Guess: 1.6153846153846154
; Guess: 1.619047619047619
; Guess: 1.6176470588235294
; Guess: 1.6181818181818182
; Guess: 1.6179775280898876
; ; Value: 1.6180555555555556
; No average-damping:
; Guess: 1.1
; Guess: 72.47657378429035
; Guess: 1.6127318474109593
; Guess: 14.45350138636525
; Guess: 2.5862669415385087
; Guess: 7.269672273367045
; Guess: 3.4822383620848467
; Guess: 5.536500810236703
; Guess: 4.036406406288111
; Guess: 4.95053682041456
; Guess: 4.318707390180805
; Guess: 4.721778787145103
; Guess: 4.450341068884912
; Guess: 4.626821434106115
; Guess: 4.509360945293209
; Guess: 4.586349500915509
; Guess: 4.535372639594589
; Guess: 4.568901484845316
; Guess: 4.546751100777536
; Guess: 4.561341971741742
; Guess: 4.551712230641226
; Guess: 4.558059671677587
; Guess: 4.55387226495538
; Guess: 4.556633177654167
; Guess: 4.554812144696459
; Guess: 4.556012967736543
; Guess: 4.555220997683307
; Guess: 4.555743265552239
; Guess: 4.555398830243649
; Guess: 4.555625974816275
; Guess: 4.555476175432173
; ; Value: 4.555574964557791
; With average-damping:
; Guess: 1.1
; Guess: 36.78828689214517
; Guess: 19.352175531882512
; Guess: 10.84183367957568
; Guess: 6.870048352141772
; Guess: 5.227224961967156
; Guess: 4.701960195159289
; Guess: 4.582196773201124
; Guess: 4.560134229703681
; Guess: 4.5563204194309606
; Guess: 4.555669361784037
; Guess: 4.555558462975639
; ; Value: 4.55553957996306
;  ... done
;;==============================================================================
;;==============================================================================
